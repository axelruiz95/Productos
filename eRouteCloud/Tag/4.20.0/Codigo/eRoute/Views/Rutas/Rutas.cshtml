@using eRoute.Helpers

@{
    ViewBag.Title = "Create";
    Layout = "~/Views/Menu/Index.cshtml";
    var bSoloLectura = ViewBag.SoloLectura;
}

<style>
    /*Estilos Propios*/

    .btn-Camiones {
        background: #b30000;
        color: #FFF;
    }

    .datos-Camiones {
        margin: 0 20px;
    }

    .Camiones-bloque {
        margin-top: 10px;
        padding: 10px;
        background-color: rgba(179, 0, 0, 0.15);
        border-radius: 5px;
        font: 12px Tahoma;
    }

    #R {
        width: 85%;
    }

    #T {
        width: 95%;
    }

    .T {
        height: 590px;
        overflow-y: auto;
    }

    .scrollY {
        width: 100%; /*manten el ancho que necesitas*/
        /*y elimina el height, de esta manera el div ira creciendo en base a la cantidad de fotos*/
        max-height: 200px;
        /*overflow-x: scroll;*/
        overflow: auto;
        margin-top: 0px;
        padding: 0px;
    }

    input, select, textarea {
        max-width: none !important;
    }

    @@media (min-width: 992px) {
        .col-md {
            width: 12.333333%;
        }
    }

    .table {
        width: 98%;
    }

    /********* SI SE NECESITA EL SCROLL**********/
    .modal-dialog {
        overflow-y: initial !important
    }

    .modal-body:not(.validateBox):not(.T) {
        height: 350px;
        overflow-y: auto;
    }

    .scroll-completo {
        /*overflow-x: scroll;
        white-space: nowrap;
        width:80%;*/
        overflow-y: scroll;
        height: 350px;
        padding-right: 0px;
    }

    .nav-tabs {
        border-bottom: 1px solid #dddddd;
        background: #75716c;
        padding: 0px 0px 0px 00px;
    }

    .scroll{
        margin-right: 0px;
    }

    .btn-productos {
        display: block;
        width: 100%;
        margin: 2px;
        text-align: center;
    }

    /**********************/
    td br {
        display: none;
    }

</style>

<div class="container" ng-controller="rutasCtrl" ng-init="EditarRuta('@ViewBag.Clave', '@ViewBag.Permiso', '@ViewBag.SoloLectura.ToString()')">

    <!--Cabecera-->
    <div class="header" style="display: block;" ng-show="ModCreate">
        <h3>&nbsp&nbsp{{translation.ERMRUTESC_MGeneralC}}</h3>
    </div>
    <div class="header" style="display: block;" ng-show="!ModCreate">
        <h3>&nbsp&nbsp{{translation.ERMRUTESC_MGeneralM}}</h3>
    </div>
    @{string sPermiso = ViewBag.Permiso;}

    <!--Formulario-->
    <div class="row">
        <div class="col-md-12">
            <form name="form" class="form-horizontal form-valor" ng-class="{submitted:form.submitted}" novalidate>
                <br />
                <div class="row form-group" ng-init="Descripcion()">
                    <!--Clave Ruta-->
                    <label class="col-md-2">
                        {{translation.RUTRUTClave}}*
                    </label>
                    <div class="col-md-4">
                        <input type="text" class="form-control" validar-clave-ruta="true" data-modal="modal" ng-model="Clave" name="Clave" placeholder="{{translation.RUTRUTClave}}" ng-required="true" ng-maxlength="10" ng-disabled="SoloLectura" />
                        <div ng-show="form.$submitted || form.Clave.$touched">
                            <div class="error-message" ng-show="form.Clave.$error.required">{{translation.BE0001.replace('$0$', translation.RUTRUTClave)}}</div>
                            <div class="error-message" ng-show="form.Clave.$error.maxlength">{{translation.E0761.replace('$0$', translation.RUTRUTClave)}}</div>
                            <div class="error-message" ng-show="form.Clave.$error.ValidarRuta">{{translation.BE0002}}</div>
                        </div>
                    </div>

                    <!--Combobox Activo/Inactivo-->
                    <label class="col-md-2">
                        {{translation.RUTTipoEstado}}*
                    </label>
                    <div class="col-md-4" ng-init="ObtenerEstado()">
                        <select id="ddlEstadoRuta" class="form-control" data-modal="modal" ng-model="TipoEstado" name="TipoEstado" ng-options="estado.VAVClave as estado.Descripcion for estado in edoreg" ng-required="true" ng-disabled="(Mensaje53||Mensaje54)">
                            <option value="" selected>{{translation.XSeleccionarOpcion}}</option>
                        </select>
                        <div class="error-message" ng-show="Mensaje53">{{translation.I0053.replace('$0$', translation.RUTRUTClave)}}</div>
                        <div class="error-message" ng-show="Mensaje54">{{translation.I0054.replace('$0$', translation.RUTRUTClave)}}</div>
                        <div ng-show="form.$submitted || form.TipoEstado.$touched">
                            <div class="error-message" ng-show="form.TipoEstado.$error.required">{{translation.BE0001.replace('$0$', translation.RUTTipoEstado)}}</div>
                        </div>
                    </div>
                </div>
                <div class="form-group row">
                    <!--Ruta/Descripcion-->
                    <div class="col-md-2">
                        <label>
                            {{translation.RUTDescripcion}}*
                        </label>
                    </div>
                    <div class="col-md-10">
                        <input type="text" class="form-control" data-modal="modal" ng-model="Descripcion" name="Descripcion" placeholder="{{translation.RUTDescripcion}}" ng-required="true" ng-maxlength="100" ng-disabled="" />
                        <div ng-show="form.$submitted || form.Descripcion.$touched">
                            <div class="error-message" ng-show="form.Descripcion.$error.required">{{translation.BE0001.replace('$0$', translation.RUTDescripcion)}}</div>
                            <div class="error-message" ng-show="form.Descripcion.$error.maxlength">{{translation.E0761.replace('$0$', translation.RUTDescripcion)}}</div>
                        </div>
                    </div>
                </div>

                <div class="row form-group" ng-init="ObtCentros()">
                    <!--Combobox Centro de distribucion-->
                    <label class="col-md-2" style="padding-right:0px;">
                        {{translation.Xcentrodistribucion}}*
                    </label>
                    <div class="col-md-10">
                        <select id="ddlCentros" style="max-width:100%" class="form-control" data-modal="modal" ng-model="AlmacenIDCEDI" ng-required="true" ng-options="val.AlmacenID as val.NombreCompuesto for val in btipouso" name="AlmacenIDCEDI" ng-disabled="">
                            <option value="" selected>{{translation.XSeleccionarOpcion}}</option>
                        </select>
                        <div ng-show="form.$submitted || form.AlmacenIDCEDI.$touched">
                            <div class="error-message" ng-show="form.AlmacenIDCEDI.$error.required">{{translation.BE0001.replace('$0$', translation.Xcentrodistribucion)}}</div>
                        </div>
                        <div class="error-message" ng-show="btipouso.isEmpty()">{{translation.E0925}}</div>
                    </div>
                </div>

                <div class="row form-group" ng-init="TipoRutas()">
                    <!--Combobox Tipo-->
                    <label class="col-md-2">
                        {{translation.RUTTipo}}*
                    </label>
                    <div class="col-md-4">
                        <select id="ddlTipoRuta" style="max-width:100%" class="form-control" data-modal="modal" ng-model="Tipo" name="Tipo" ng-options="tipo.VAVClave as tipo.Descripcion for tipo in tindmod" ng-required="true" ng-change="Inventario='null'" ng-disabled="">
                            <option value="" selected>{{translation.XSeleccionarOpcion}}</option>
                        </select>
                        <div ng-show="form.$submitted || form.Tipo.$touched">
                            <div class="error-message" ng-show="form.Tipo.$error.required">{{translation.BE0001.replace('$0$', translation.RUTTipo)}}</div>
                        </div>
                    </div>
                    <!--Inventario-->
                    <label class="col-md-2" style="padding-right:0px;">
                        {{translation.RUTInventario}}
                    </label>
                    <div class="col-md-4" style="padding-top:7px;">
                        <input class="activo-mg" type="checkbox" ng-model="Inventario" name="Inventario" ng-checked="Estado" ng-false-value="0" ng-true-value="1" ng-disabled="Tipo!='2'">
                    </div>
                </div>

                <!--Camiones /ventana emergente-->
                <div class="row form-group">
                    <!--Label-->
                    <div class="col-md-2" style="padding-right:0px;">
                        <label for="">
                            {{translation.RUTCAMPlaca}}
                        </label>
                    </div>
                    <!--Ventana emergente-->
                    <div class="col-md-4">
                        <div class="input-group">
                            <input type="text" name="Camiones" id="Camiones" ng-model="Camiones" class="form-control" validar-clave-camion="true" ng-change="CamionesNombre='';CamionDisponible()" ng-disabled="">
                            <span class="input-group-btn">
                                <button class="btn btn-secondary btn-Camiones @*btn-default*@" ng-click="ObtCamiones(); SeleccionarVehiculo()" type="button" ng-disabled=""><i class="fa fa-ellipsis-h" aria-hidden="true"></i></button>
                            </span>
                        </div>
                        <div ng-show="form.$submitted || form.Camiones.$touched">
                            <div class="error-message" ng-show="form.Camiones.$error.ValidarCamion">{{translation.E0015}}</div>
                        </div>
                    </div>
                    <!--Text con vaciado de datos de camiones-->
                    <div class="col-md-6">
                        <input ng-disabled="true" type="text" name="CamionesNombre" id="CamionesNombre" ng-model="CamionesNombre" class="form-control">
                    </div>
                </div>

                <!------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->
                <!------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->
                <!--Nueva seccion de esquemas de producto-->
                <!--Clientes-->
                <fieldset>
                    <legend>{{translation.CBOEsquemaProductos}}</legend>
                    <!--Tabla de Clientes y Botones-->
                    <div class="row form-group">
                        <div class="col-md-10 table-responsive scroll-completo">
                            <table cellpadding="12" class="table table-bordered table-hover">
                                <!--Encabezado tabla-->
                                <thead>
                                    <tr>
                                        <th></th>
                                        @{  if (!bSoloLectura)
                                            {
                                                <!--Orden ascendente o descendente-->
                                                <th class="cursor-pointer" ng-click="sort('Clave')"><b>{{translation.XClave}}</b><span class="glyphicon sort-icon" ng-show="sortKey=='Clave'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span></th>
                                                <th class="cursor-pointer" ng-click="sort('Nombre')"><b>{{translation.PDVNombre}}</b><span class="glyphicon sort-icon" ng-show="sortKey=='Nombre'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span></th>
                                            }
                                            else
                                            {
                                                <th> <b>{{translation.XClave}}</b> </th>
                                                <th> <b>{{translation.PDVNombre}}</b> </th>
                                            }
                                        }
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr ng-repeat="E in EsquemasList|orderBy:sortKey:reverse|orderBy:Lock:true|filter:search">
                                        <td><!--Eliminar-->
                                            @{
                                                if (sPermiso.Contains("D"))
                                                {
                                                    @Html.ImageButton("../Content/images/eliminar.png", "Remove($index, E.EsquemaID)", "{{translation.BTEliminar}}")
                                                }
                                            }
                                        </td>
                                        <td class="Edit Edit{{$index}}" ng-init="Editable(E.Clave);" ng-keypress="prueba($event);">{{E.Clave}}</td>
                                        <td>{{E.Nombre}}</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="col-md-2">
                            @{  if (!bSoloLectura)
                                {
                                    <input type="button" value="{{translation.BTCrear}}" class="btn-productos btn btn-default" ng-click="Nuevo();" />
                                    <input type="button" value="{{translation.BTBuscar}}" class="btn-productos btn btn-default" ng-click="Esquemas();SeleccionarProductos();" />
                                }
                            }
                        </div>
                    </div>
                </fieldset>
                <!--Fin de la nueva seccion-->
                <!------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->
                <!------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------->
                <br />
                <div class="container" style="margin-left: 20px">
                    @{  if (!bSoloLectura)
                        {
                            <input type="submit" value="{{translation.BTAceptar}}" class="btn btn-default" ng-click="Save()" />
                            <input type="button" value="{{translation.BTCancelar}}" class="btn btn-default" ng-click="ValidarCancelar()" />
                        }
                        else
                        {
                            <input type="button" value="{{translation.BTAceptar}}" class="btn btn-default" ng-click="ValidarCancelar()" />
                        }
                    }
                </div>
            </form>
            @{ Html.RenderPartial("Rutas/VehiculoBox"); }
            @{ Html.RenderPartial("Rutas/RutaProductoBox"); }
            @{ Html.RenderPartial("MsgBox/MsgBox"); }
            @{ Html.RenderPartial("MsgBox/MsgBoxAux"); }
            @{ Html.RenderPartial("MsgBox/YesNoMsgBoxAux"); }
        </div>
    </div>
</div>