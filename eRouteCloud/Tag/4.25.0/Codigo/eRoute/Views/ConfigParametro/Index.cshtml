@using eRoute.Helpers

@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Menu/Index.cshtml";
    var bSoloLectura = ViewBag.SoloLectura;
}


<style>
    /*Estilos Propios*/

    .btn-Parametro {
        background: #b30000;
        color: #FFF;
    }

    .datos-Parametro {
        margin: 0 20px;
    }

    .Parametro-bloque {
        margin-top: 10px;
        padding: 10px;
        background-color: rgba(179, 0, 0, 0.15);
        border-radius: 5px;
        font: 12px Tahoma;
    }

    #R {
        width: 85%;
    }

    #T {
        width: 95%;
    }

    .T {
        height: 590px;
        overflow-y: auto;
    }

    .scrollY {
        width: 100%; /*manten el ancho que necesitas*/
        /*y elimina el height, de esta manera el div ira creciendo en base a la cantidad de fotos*/
        max-height: 200px;
        /*overflow-x: scroll;*/
        overflow: auto;
        margin-top: 0px;
        padding: 0px;
    }

    input, select, textarea {
        max-width: none !important;
    }

    @@media (min-width: 992px) {
        .col-md {
            width: 12.333333%;
        }
    }

    .table {
        width: 98%;
        margin: 0;
        padding: 0;
        display: table;
        table-layout: auto;
    }

    /********* SI SE NECESITA EL SCROLL**********/
    .modal-dialog {
        overflow-y: initial !important
    }

    .modal-body:not(.validateBox):not(.T) {
        height: 400px;
        overflow-y: auto;
        /*white-space: nowrap;
        overflow-x: auto;*/
    }

    .modal-body-header {
        overflow-y: auto;
    }

    .scroll-completo {
        /*overflow-x: scroll;
        white-space: nowrap;
        width:80%;*/
        overflow-y: scroll;
        height: 350px;
        padding-right: 0px;
    }

    .nav-tabs {
        border-bottom: 1px solid #dddddd;
        background: #75716c;
        padding: 0px 0px 0px 00px;
    }

    .scroll {
        margin-right: 0px;
    }

    /**********************/

</style>

<div class="container" ng-controller="configParametroCtrl" ng-init="AsignarPermisoConfigParametro('@ViewBag.Permiso');">

    <!--Encabezado-->
    <div class="header" style="display: block;">
        <h3>&nbsp&nbsp{{translation.XMConfiguracion}} de {{translation.XParametros}}</h3>
        @{string sPermiso = ViewBag.Permiso;}
    </div>

    <!--Formulario-->
    <div class="row">
        <div class="col-md-12">
            <form name="form" ng-model="form" class="form-horizontal form-valor" ng-class="{submitted:form.submitted}" ng-init="ObtenerParametros(); MotCon = false; Modulo = false;" novalidate>
                <br />

                <div class="row form-group" ng-init="TipoNivel();">
                    <!--Parámetro-->
                    <div class="col-md-2">
                        <label>
                            {{translation.ADEParametro}}*
                        </label>
                    </div>
                    <!--Ventana emergente Parametro-->
                    <div class="col-md-4">
                        <div class="input-group">
                            <input type="text" name="Parametro" id="Parametro" ng-model="Parametro" class="form-control" placeholder="{{translation.ADEParametro}}" ng-change="Observaciones='';ObtenerDescripcion();" ng-required="true" validar-parametro="true">
                            <span class="input-group-btn">
                                <button class="btn btn-secondary btn-Parametro @*btn-default*@" ng-click="MensajeParametros();SeleccionarParametro();" type="button"><i class="fa fa-ellipsis-h" aria-hidden="true"></i></button>
                            </span>
                        </div>
                        <div ng-show="form.$submitted || form.Parametro.$touched">
                            <div class="error-message" ng-show="form.Parametro.$error.required">{{translation.BE0001.replace('$0$', translation.ADEParametro)}}</div>
                            <div class="error-message" ng-show="form.Parametro.$error.ValidarParametro">El Parámetro no corresponde a ninguno existente o no se encuentra Activo</div>
                        </div>
                    </div>
                    <!--Nivel-->
                    <div class="col-md-2">
                        <label>
                            Nivel
                        </label>
                    </div>
                    <!--combo Nivel-->
                    <div class="col-md-4">
                        <select id="ddlNivel" style="max-width:100%" class="form-control" data-modal="modal" ng-model="Nivel" name="Nivel" ng-options="nivel.VAVClave as nivel.Descripcion for nivel in nipa" ng-change="ValidarActivo();">
                            <option value="" selected>{{translation.XSeleccionarOpcion}}</option>
                        </select>
                    </div>
                </div>

                <div class="row form-group">
                    <!--Valor-->
                    <div class="col-md-2">
                        <label>
                            {{translation.ADEValor}}*
                        </label>
                    </div>
                    <!--Vaciado de datos correspondientes al Valor-->
                    <div class="col-md-10">
                        <div>
                            <input type="text" name="Valor" id="Valor" ng-model="Valor" class="form-control" placeholder="Valor" ng-required="true" ng-maxlength="500">
                        </div>
                        <div ng-show="form.$submitted || form.Valor.$touched">
                            <div class="error-message" ng-show="form.Valor.$error.required">{{translation.BE0001.replace('$0$', translation.ADEValor)}}</div>
                            <div class="error-message" ng-show="form.Valor.$error.maxlength">{{translation.E0761.replace('$0$', translation.ADEValor)}}</div>
                        </div>
                    </div>
                </div>

                <div class="row form-group" ng-init="TipoAplicacion();">
                    <!--Identificador-->
                    <div class="col-md-2">
                        <label>
                            {{translation.PROId}}*
                        </label>
                    </div>
                    <!--Ventana emergente Identificador-->
                    <div class="col-md-4">
                        <div class="input-group">
                            <input type="text" name="Identificador" id="Identificador" ng-model="Identificador" class="form-control" placeholder="{{translation.PROId}}" ng-required="true" validar-identificador="true">
                            <span class="input-group-btn">
                                <button class="btn btn-secondary btn-Parametro @*btn-default*@" ng-click="SeleccionarIdentificador(); ObtenerIdentificadores();" type="button" ng-disabled="Activo"><i class="fa fa-ellipsis-h" aria-hidden="true"></i></button>
                            </span>
                        </div>
                        <div ng-show="form.$submitted || form.Identificador.$touched">
                            <div class="error-message" ng-show="form.Identificador.$error.required">{{translation.BE0001.replace('$0$', translation.PROId)}}</div>
                            <div class="error-message" ng-show="form.Identificador.$error.ValidarIdentificador">El Identificador no corresponde a ninguno existente o no se encuentra Activo</div>
                        </div>
                    </div>
                    <!--Tipo Aplicacion-->
                    <div class="col-md-2">
                        <label>
                            {{translation.CMATipoAplicacion}}*
                        </label>
                    </div>
                    <!--Ventana emergente Nivel-->
                    <div class="col-md-4">
                        <select id="ddlAplicacion" style="max-width:100%" class="form-control" data-modal="modal" ng-model="Aplicacion" name="Aplicacion" ng-options="aplicacion.VAVClave as aplicacion.Descripcion for aplicacion in bmenapl" ng-required="true" ng-change="">
                            <option value="" selected>{{translation.XSeleccionarOpcion}}</option>
                        </select>
                        <div ng-show="form.$submitted || form.Aplicacion.$touched">
                            <div class="error-message" ng-show="form.Aplicacion.$error.required">{{translation.BE0001.replace('$0$', translation.CMATipoAplicacion)}}</div>
                        </div>
                    </div>
                </div>

                <div class="row form-group">
                    <!--Observaciones-->
                    <div class="col-md-2">
                        <label>
                            {{translation.MOVObservaciones}}
                        </label>
                    </div>
                    <!--Vaciado de datos correspondientes al Mensaje del parametro-->
                    <div class="col-md-10">
                        <div>
                            <input ng-disabled="true" type="text" name="Observaciones" id="Observaciones" ng-model="Observaciones" class="form-control">
                        </div>
                    </div>
                </div>

                <div class="row form-group">
                    <div class="col-md-12 text-right">
                        <input type="submit" value="{{translation.BTAceptar}}" class="btn btn-default" ng-click="ValidarAceptar();" ng-init="Activo=true"/>
                        <input type="button" value="{{translation.BTCancelar}}" class="btn btn-default" ng-click="ValidarCancelar();" />
                    </div>
                </div>

                <div class="row form-group">
                    <div class="col-md-12">
                        <!--Clientes-->
                        <fieldset>
                            <legend>Parámetros Activos</legend>
                            <!--Tabla de Parámetros actualmente configurados-->
                            <div class="row form-group">
                                <div class="col-md-12 table-responsive scroll-completo">
                                    <table cellpadding="12" class="table table-bordered table-hover">
                                        <!--Encabezado tabla-->
                                        <thead>
                                            <tr>
                                                <!--Orden ascendente o descendente-->
                                                <th></th>
                                                <th class="cursor-pointer" ng-click="sort('MENClave')"><b>{{translation.ADEParametro}}</b><span class="glyphicon sort-icon" ng-show="sortKey=='MENClave'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span></th>
                                                <th class="cursor-pointer" ng-click="sort('Identificador')"><b>{{translation.PROId}}</b><span class="glyphicon sort-icon" ng-show="sortKey=='Identificador'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span></th>
                                                <th class="cursor-pointer" ng-click="sort('Valor')"><b>{{translation.ADEValor}}</b><span class="glyphicon sort-icon" ng-show="sortKey=='Valor'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span></th>
                                                <th class="cursor-pointer" ng-click="sort('Nivel')"><b>Nivel</b><span class="glyphicon sort-icon" ng-show="sortKey=='Nivel'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span></th>
                                                <th class="cursor-pointer" ng-click="sort('TipoAplicacion')"><b>{{translation.CMATipoAplicacion}}</b><span class="glyphicon sort-icon" ng-show="sortKey=='TipoAplicacion'" ng-class="{'glyphicon-chevron-up':reverse,'glyphicon-chevron-down':!reverse}"></span></th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr ng-repeat="P in ListaParametros|orderBy:sortKey:reverse|filter:search" ng-click="">
                                                <td>
                                                    <!--Eliminar-->
                                                    @{ if (sPermiso.Contains("D"))
                                                    {
                                                        @Html.ImageButton("../Content/images/eliminar.png", "ValidarEliminar(P.Parametro, P.Identificador)", "{{translation.BTEliminar}}")
                                                }
                                                    }
                                                </td>
                                                <td>{{P.Parametro}}</td>
                                                <td>{{P.Identificador}}</td>
                                                <td>{{P.Valor}}</td>
                                                <td>{{P.Nivel}}</td>
                                                <td>{{P.TipoAplicacion}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </fieldset>
                    </div>
                </div>
            </form>
        </div>
        <!--Referencia a Ventanas modales-->
        @{ Html.RenderPartial("MsgBox/MsgBox"); }
        @{ Html.RenderPartial("MsgBox/YesNoMsgBoxAux"); }
        @{ Html.RenderPartial("MsgBox/MsgBoxAux"); }
        @{ Html.RenderPartial("MsgBox/ParametrosBox"); }
        @{ Html.RenderPartial("MsgBox/IdentificadorBox"); }
    </div>
</div>