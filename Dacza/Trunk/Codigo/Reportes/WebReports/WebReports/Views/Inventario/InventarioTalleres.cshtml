@model IEnumerable<WebReports.Models.InventarioTaller>

@{
    ViewBag.Title = "Inventario de Talleres";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<hgroup class="title">
    <h1 class="text-center">@ViewBag.Title</h1>    
</hgroup>
<p />

 <div class="container">
    
        @{
            WebReports.Models.FilterModels.FilterInventario filtro = (WebReports.Models.FilterModels.FilterInventario)Session["Filtro"]; 
            String sFiltro= "";
            int nCont = 0;
            if(!filtro.Sucursal.IsEmpty())
            {
                String sucursal = Session["Sucursal"].ToString();
                nCont++;
                <div class="container-left-filter">
                    <h2>Sucursal: @sucursal</h2>
                </div>
            } 
            if(!filtro.Taller.IsEmpty() && !filtro.Taller.Equals("-999"))
            {
                String taller = Session["Taller"].ToString();
                if (nCont == 0)
                {
                    <div class="container-left-filter">
                        <h2>Taller: @taller</h2>
                    </div>
                }
                else 
                {
                    <div class="container-right-filter">
                        <h2>Taller: @taller</h2>
                    </div>
                }
            } 
            
        }     
</div>

<p></p>

 <div class="panel-group">
    @{        
        List<WebReports.Models.InventarioTaller> talleres = Model.GroupBy(x => x.Taller.TallerId).Select(g => g.First()).OrderBy(x => x.Taller.Clave).ToList();        
        
        foreach (var item in talleres) {
           
                @Html.Raw("<div class=\"panel panel-default\">")
                @Html.Raw("<div class=\"panel-heading panel-heading-top\">")
                @Html.Raw("<h4 class=\"panel-title\">")
                @Html.Raw("<a data-toggle=\"collapse\" href=#" + @item.Taller.TallerId + ">" + @item.Taller.Descripcion + "</a>")
                @Html.Raw("</h4>")
                @Html.Raw("</div>")
                @Html.Raw("<div id=" + @item.Taller.TallerId + " class=\"panel-collapse collapse\">")
                @Html.Partial("InventarioTaller", Model.ToList().FindAll(x => x.Taller.TallerId == item.Taller.TallerId).OrderBy(x => x.Articulo.Clave).ToList())
                @Html.Raw("</div>")
                @Html.Raw("</div>")
            
         }//foreach (var item in Model)       
                 
     }   
 </div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script src="../Scripts/bootstrap.min.js" type="text/javascript"></script>

}
